<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=Content-Language content="en"><meta name=color-scheme content="light dark"><meta name=author content="Christian Ekrem"><meta name=description content="Creating a React app!"><meta name=keywords content="developer,personal"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cekrem.github.io/images/featured-with-margins.png"><meta name=twitter:title content="Exploring UIs in the terminal part 1: React/Ink"><meta name=twitter:description content="Creating a React app!"><meta property="og:url" content="https://cekrem.github.io/posts/do-more-stuff-cli-tool-part-1/"><meta property="og:site_name" content="cekrem.github.io"><meta property="og:title" content="Exploring UIs in the terminal part 1: React/Ink"><meta property="og:description" content="Creating a React app!"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-29T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-29T00:00:00+00:00"><meta property="article:tag" content="Cli"><meta property="article:tag" content="Ui"><meta property="article:tag" content="Npm Package"><meta property="article:tag" content="React"><meta property="article:tag" content="Ink"><meta property="og:image" content="https://cekrem.github.io/images/featured-with-margins.png"><title>Exploring UIs in the terminal part 1: React/Ink · cekrem.github.io
</title><link rel=canonical href=https://cekrem.github.io/posts/do-more-stuff-cli-tool-part-1/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.34dfa7b2f5cdeb0f5302b2628f4a7a4bfe88a2431e1397ee4ec605c56ab69701.css integrity="sha256-NN+nsvXN6w9TArJij0p6S/6IokMeE5fuTsYFxWq2lwE=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.d8f89ef09509afb63b9b2595ee174e53cc51ce02a6f6a2179e1621f9389e4340.css integrity="sha256-2Pie8JUJr7Y7myWV7hdOU8xRzgKm9qIXnhYh+TieQ0A=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><meta name=generator content="Hugo 0.126.3"></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>cekrem.github.io
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/devplan/>Development Plan</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://cekrem.github.io/posts/do-more-stuff-cli-tool-part-1/>Exploring UIs in the terminal part 1: React/Ink</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2023-08-29T00:00:00Z>August 29, 2023
</time></span><span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
4-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/cli/>cli</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/ui/>ui</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/npm-package/>npm package</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/react/>react</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/ink/>ink</a></span></div></div></header><div><h2 id=where-do-uis-belong>Where do UIs belong?
<a class=heading-link href=#where-do-uis-belong><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Most of us consider ReactJS a tool for rendering UI components on the web (or the DOM, specifically), and if by &ldquo;React&rdquo; we mean &ldquo;ReactDOM&rdquo; then we&rsquo;re right. But as we&rsquo;ve seen with React Native, React is not confined to the DOM at all, and can render to any number of environments. After all, like it says on the box, React is a &ldquo;JavaScript library for building user interfaces&rdquo;. We&rsquo;ve seen the same with <a href=https://www.jetbrains.com/lp/compose-multiplatform/>Compose Multiplatform</a>: what used to be a framework for creating Android UI can actually be used for so much more.</p><p>Personally I think the actual <em>rendering</em> part of both React and Compose is super interesting! But it feels a bit overwhelming to dive in to all that&rsquo;s going on when interacting with the DOM, let alone the mobile targets with all their domain specific weirdness. If only there was an even simpler environment where a UI could live. Something a lot more constrained and minimalistic than web/mobile, and ideally something I&rsquo;m already familiar with&mldr;</p><h2 id=the-terminal>The terminal!
<a class=heading-link href=#the-terminal><i class="fa fa-link" aria-hidden=true></i></a></h2><p>The simplicity, power and general feelgood of a properly set up terminal is just unbeatable. Mine is not as heavily customized as it used to be, especially after I started using <a href=https://www.warp.dev/>Warp</a>, but it&rsquo;s still the space I spend most time tweaking to my liking. And even after growing quite dependent on Android Studio for Android stuff, it&rsquo;s still an environment I spend a lot of my working hours in. <strong>And I recently learned that there are libraries available for using both React and Compose for the terminal</strong>! The one and only Jake Wharton has made <a href=https://github.com/JakeWharton/mosaic>Mosaic</a>, &ldquo;an experimental tool for building console UI in Kotlin using the Jetpack Compose compiler/runtime.&rdquo; Mosaic is based on <a href=https://github.com/vadimdemedes/ink>ink</a>, which is basically the same only it&rsquo;s using React instead of Compose to render. To be fair, btw, ink came first; if we&rsquo;re giving out points the first one goes to the React community.</p><p>These libraries are great for two reasons:</p><ol><li>it&rsquo;s a lot more fun to write React/Compose than doing <code>printf("\033[%dB", lineNumber)</code> til kingdom come just to move your cursor.</li><li>It&rsquo;s a perfect case study to learn how rendering works.</li></ol><h2 id=starting-with-ink>Starting with ink
<a class=heading-link href=#starting-with-ink><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Since I&rsquo;m already somewhat familiar with how React rendering works when targeting the DOM, this is where I&rsquo;ll start my terminal UI adventure: <strong>I&rsquo;ll create a simple yet hopefully useful CLI as a case study for rendering UI in the terminal</strong>. In the next part I&rsquo;ll try and make the same tool only using Mosaic instead. If my courage doesn&rsquo;t fail me, I&rsquo;ll sum it all up with a final post exploring some differences and key takeaways from both libraries. Maybe, just maybe, I&rsquo;ll be inspired to make something similar myself with Elm or something. Exciting!</p><h2 id=what-i-made>What I made
<a class=heading-link href=#what-i-made><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Basically, I made <code>domorestuff</code>, a simple tool to run multiple shell commands in parallel, and inspect the output of each one. Since ink actually supports all React features, it felt instantly familiar. The only sort of domain specific caveat I encountered was how to keep the app from exciting after initial output. TL;DR: it seems any input listener or interval running will keep stuff alive, but there might be more to it than that.</p><p><img src=inkdomorestuff.gif alt="domorestuff, ink edition"></p><p>You can try the tool yourself, just <code>npx domorestuff</code>. I&rsquo;ve taken a few shortcuts here and there, but the <a href=https://github.com/cekrem/domorestuff>source code</a> should be fairly straight forward for those familiar with React.</p><p>In fact, let me prove that:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSX data-lang=JSX><span style=display:flex><span><span style=font-style:italic>// source/command.js sure looks like React to me!
</span></span></span><span style=display:flex><span><span style=font-style:italic></span>
</span></span><span style=display:flex><span><span style=font-weight:700>import</span> React, {useEffect, useState} from <span style=font-style:italic>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=font-weight:700>import</span> {Box, Spacer, Text} from <span style=font-style:italic>&#39;ink&#39;</span>;
</span></span><span style=display:flex><span><span style=font-weight:700>import</span> {spawn} from <span style=font-style:italic>&#39;child_process&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>export</span> <span style=font-weight:700>const</span> Command = ({cmd, active}) =&gt; {
</span></span><span style=display:flex><span>	<span style=font-weight:700>const</span> [summary, setSummary] = useState(<span style=font-style:italic>&#39;&#39;</span>);
</span></span><span style=display:flex><span>	<span style=font-weight:700>const</span> [color, setColor] = useState(COLORS.pending);
</span></span><span style=display:flex><span>	<span style=font-weight:700>const</span> [output, setOutput] = useState(<span style=font-weight:700>null</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	useEffect(() =&gt; {
</span></span><span style=display:flex><span>		<span style=font-style:italic>// {skipped for brevity, TL;DR: spawn process, handle output etc}
</span></span></span><span style=display:flex><span><span style=font-style:italic></span>	}, [cmd]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=font-weight:700>return</span> (
</span></span><span style=display:flex><span>		&lt;<span style=font-weight:700>Box</span>
</span></span><span style=display:flex><span>			overflow=<span style=font-style:italic>&#34;hidden&#34;</span>
</span></span><span style=display:flex><span>			flexDirection=<span style=font-style:italic>&#34;column&#34;</span> <span>//</span> it even has flexbox<span>!</span>
</span></span><span style=display:flex><span>			width=<span style=font-style:italic>&#34;100%&#34;</span>
</span></span><span style=display:flex><span>			borderStyle=<span style=font-style:italic>&#34;bold&#34;</span>
</span></span><span style=display:flex><span>			borderColor={color}
</span></span><span style=display:flex><span>		&gt;
</span></span><span style=display:flex><span>			&lt;<span style=font-weight:700>Box</span>&gt;
</span></span><span style=display:flex><span>				&lt;<span style=font-weight:700>Text</span> bold&gt;
</span></span><span style=display:flex><span>					{<span style=font-style:italic>`</span><span style=font-weight:700;font-style:italic>${</span>active ? <span style=font-style:italic>&#39;* &#39;</span> : <span style=font-style:italic>&#39;&#39;</span><span style=font-weight:700;font-style:italic>}${</span>cmd<span style=font-weight:700;font-style:italic>}</span><span style=font-style:italic>`</span>}
</span></span><span style=display:flex><span>					{!active &amp;&amp; output?.length &gt; 1 &amp;&amp; &lt;<span style=font-weight:700>Text</span> dimColor&gt; (...)&lt;/<span style=font-weight:700>Text</span>&gt;}
</span></span><span style=display:flex><span>				&lt;/<span style=font-weight:700>Text</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>				&lt;<span style=font-weight:700>Spacer</span> /&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>				&lt;<span style=font-weight:700>Text</span> color={color}&gt;{summary}&lt;/<span style=font-weight:700>Text</span>&gt;
</span></span><span style=display:flex><span>			&lt;/<span style=font-weight:700>Box</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			{active &amp;&amp; output?.length &gt; 1 &amp;&amp; (
</span></span><span style=display:flex><span>				&lt;<span style=font-weight:700>Box</span> marginTop=<span style=font-style:italic>&#34;1&#34;</span> overflow=<span style=font-style:italic>&#34;hidden&#34;</span>&gt;
</span></span><span style=display:flex><span>					&lt;<span style=font-weight:700>Text</span> overflow=<span style=font-style:italic>&#34;hidden&#34;</span> wrap=<span style=font-style:italic>&#34;truncate&#34;</span>&gt;
</span></span><span style=display:flex><span>						{output.toString().trim()}
</span></span><span style=display:flex><span>					&lt;/<span style=font-weight:700>Text</span>&gt;
</span></span><span style=display:flex><span>				&lt;/<span style=font-weight:700>Box</span>&gt;
</span></span><span style=display:flex><span>			)}
</span></span><span style=display:flex><span>		&lt;/<span style=font-weight:700>Box</span>&gt;
</span></span><span style=display:flex><span>	);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>It&rsquo;s not fair make comparisons before I&rsquo;ve at least tried Mason, but I can say straight away that ink is super smooth. Also, NPM is a <em>very</em> efficient means to publish CLI tools. You&rsquo;re basically done before even starting. I might even use NPM to publish the Kotlin/Compose version of this app as well, that&rsquo;s how smooth the ecosystem is. (Yes, it&rsquo;s perfectly fine to publish non-JavaScript binaries, as demonstrated with <a href=/posts/create-elm-live-app/#the-simplest-possible-solution-that-actually-works>create-elm-live-app</a>.)</p><p>Stay tuned for part two: <code>doevenmorestuff</code>, starring Kotlin, Compose and Mason! Coming soon.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>© 2021 - 2024 Christian Ekrem
<script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-emoji=🍺 data-id=cekrem data-description="Support me on Buy me a coffee!" data-message data-color=#ddd data-position=Right data-x_margin=18 data-y_margin=18></script></section></footer></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script><script data-goatcounter=https://cekrem.goatcounter.com/count async src=//gc.zgo.at/count.js></script></body></html>